<!DOCTYPE html>
<html>
<head>
	<title>giphy-api</title>
	<link href="style.css" rel="stylesheet" type="text/css"></link>
</head>
<body>
	<script type="text/javascript" src="https://code.jquery.com/jquery-3.2.1.min.js"
  	integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  	crossorigin="anonymous"></script>

	<form id="movie-form">
      <label for="movie-input">Search</label><br>
      <input type="text" id="movie-input">
      <input id="add-movie" type="submit" value="Add Button">
    </form>

	<div id="buttons">
	</div>
	
	<div id="response">
	</div>

	<script type="text/javascript">
		var topics = ['denzel washington', 'big lebowski', 'game of thrones', 'star wars', 'batman', 'x-men', 'fargo', 'pulp fiction']

		for(i = 0; i < topics.length; i++){
			var button = $('<button class=buttonTopic>').text(topics[i]);
			$('#buttons').append(button);
		};

		var topicChoice = '';
		var queryURL = '';

		$(document).on('click', '.buttonTopic', function(){
			$('#response').html('');
			var topicChoice = $(this).text();
			var queryURL = "https://api.giphy.com/v1/gifs/search?q=" + topicChoice + "&api_key=dc6zaTOxFJmzC"
			$.ajax({
				url:queryURL, 
				method:'GET'
			}).done(function(response){
				for(i = 0; i < 10; i++){
				var container = $('<div>').addClass('img-container');
        		var image = $('<img>');
        		image.attr('src', response.data[i].images.fixed_height_still.url);
        		image.attr('data-still', response.data[i].images.fixed_height_still.url);
        		image.attr('data-animate', response.data[i].images.fixed_height.url);
        		image.attr('state', 'still');
        		image.addClass('gif');
        		container.append(image);
        		container.append('<p>Rating: ' + response.data[i].rating + '</p>');
        		$('#response').append(container);        		
      			};	
			});
		});

		$(document).on('click', '.gif', function(){

			if ($(this).attr('state') === 'still'){
			$(this).attr('src', $(this).attr('data-animate'));
			$(this).attr('state', 'animate');
			} else {
				// make it so url turns back to _s in middle
			$(this).attr('src', $(this).attr('data-still'));
			$(this).attr('state', 'still');
			}
		});



		$("#add-movie").on("click", function() {
        // This function below prevents the page from reloading
          event.preventDefault(); 
          var input = $('#movie-input').val()
          var button1 = $('<button class=buttonTopic>').text(input)
          $('#buttons').append(button1)
      	});

	</script>
</body>
</html>